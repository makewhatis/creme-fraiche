---
language: python
python:
- '2.6'
- '2.7'
before_install:
- sudo apt-get install libevent-dev python-dev
- psql -c 'create database creme_fraiche;' -U postgres
- pip install -q -r requirements.txt
script: python setup.py test
notifications:
  email:
  - david@makewhatis.com
  - captainschreck@gmail.com
env:
  global:
  - secure: ! 'WxNmmOowpVM86hKzAPOqeY1WS1l9Kq+3OJOcHjAWQbWLX4vPYod1TF7fnBfv1QDSNFLn6pGsFRyA695pkeLVGltSVN+5kbohx4gwSo0mEcFLzk+7w2TPUgdZB0BpPa7YciResSs57RRBUFnH0ZNn5yhP5pF85+PLBNA223v3lvU='

after_script:
  # Install the Heroku gem (or the Heroku toolbelt)
  - rm -rf .git*
  - gem install heroku
  # Turn off warnings about SSH keys:
  - echo "Host heroku.com" >> ~/.ssh/config
  - echo "   StrictHostKeyChecking no" >> ~/.ssh/config
  - echo "   CheckHostIP no" >> ~/.ssh/config
  - echo "   UserKnownHostsFile=/dev/null" >> ~/.ssh/config
  # Clear your current Heroku SSH keys:
  - heroku keys:clear
  # Add a new SSH key to Heroku
  - yes | heroku keys:add
  # Add your Heroku git repo:
  - git clone git@heroku.com:creme-fraiche.git heroku
  - cd heroku
  - git config --global user.email "travis-ci@internets.ci"
  - git config --global user.name "Travis CI"
  # Push to Heroku!
  - date > date.txt
  - git commit -a -m "auto update."
  - yes | git push origin master
